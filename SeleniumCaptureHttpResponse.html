<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Example web page for SeleniumCaptureHttpResponse GitHub repository.</title>
    <link rel="stylesheet" href="style.css ">
</head>
<body>
    <p>The purpose of this web page is to act as an example web page for <a href="https://github.com/metaljase/SeleniumCaptureHttpResponse">my SeleniumCaptureHttpResponse repository</a> on GitHub.</p>
    
    <p>Utilising Selenium, ChromeDriver, Chrome DevTools, and C#, SeleniumCaptureHttpResponse demonstrates how to capture the HTTP response from an API call performed on a 3rd party web page. This can be useful for testing, or as part of scraping 3rd party websites. Specifically, SeleniumCaptureHttpResponse demonstrates capturing JSON from the message body of an HTTP response, then deserializing it.</p>

    <p>Below is <i>some</i> data returned from the API call which was performed by the JavaScript on this page. SeleniumCaptureHttpResponse will capture <i>all</i> the data as JSON.</p>

    <table>
        <thead>
            <tr><th>Name</th><th>Email Address</th></tr>
        </thead>
        <tbody id="users">
        </tbody>
    </table>

    <script>
        const tbody = document.getElementById('users');
        const rows = document.createDocumentFragment();
        const url = 'https://jsonplaceholder.typicode.com/users/';

        async function getUsers() {
            let response = await fetch(url);
            let data = await response.json();
            return data;
        }

        getUsers()
            .then(json => {
                json.map(function (users) {
                    let tr = document.createElement('tr');

                    let tdName = document.createElement('td');
                    tdName.innerHTML = `${users.name}`;
                    tr.append(tdName);

                    let tdEmail = document.createElement('td');
                    tdEmail.innerHTML = `${users.email}`;
                    tr.append(tdEmail);

                    rows.append(tr);
                });
                tbody.append(rows)
            })
            .catch(function (error) {
                console.log(error);
            });
    </script>
</body>
</html>